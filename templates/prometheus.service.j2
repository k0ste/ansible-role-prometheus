{{ '## ' + 'prometheus.conf' }}
{{ '# ' + ansible_managed }}
{{ '# ' + 'Do not edit manually' }}

{% for o in vars['prometheus_service_settings'] %}
{% if loop.first %}
{{ '[Service]' }}
{{ 'ExecStart' + '=' }}
{{ 'ExecStart' + '=' + hostvars[inventory_hostname]['prometheus_bin'] -}}
{% endif %}
{% if o.config_file is defined and o.config_file != '' -%}
{{ ' \\' }}
{{ '--config.file=' + o.config_file -}}
{% endif %}
{% if o.web_config_file is defined and o.web_config_file != '' %}
{{ ' \\' }}
{{ '--web.config.file=' + o.web_config_file -}}
{% endif %}
{% if o.web_listen_address is defined and o.web_listen_address != '' %}
{{ ' \\' }}
{{ '--web.listen-address=' + o.web_listen_address -}}
{% endif %}
{% if o.web_read_timeout is defined and o.web_read_timeout != '' %}
{{ ' \\' }}
{{ '--web.read-timeout=' ~ o.web_read_timeout -}}
{% endif %}
{% if o.web_max_connections is defined and o.web_max_connections != '' %}
{{ ' \\' }}
{{ '--web.max-connections=' ~ o.web_max_connections -}}
{% endif %}
{% if o.web_external_url is defined and o.web_external_url != '' %}
{{ ' \\' }}
{{ '--web.external-url=' + o.web_external_url -}}
{% endif %}
{% if o.web_route_prefix is defined and o.web_route_prefix != '' %}
{{ ' \\' }}
{{ '--web.route-prefix=' + o.web_route_prefix -}}
{% endif %}
{% if o.web_user_assets is defined and o.web_user_assets != '' %}
{{ ' \\' }}
{{ '--web.user-assets=' + o.web_user_assets -}}
{% endif %}
{% if o.web_enable_lifecycle is defined and o.web_enable_lifecycle == 'true' %}
{{ ' \\' }}
{{ '--web.enable-lifecycle' -}}
{% endif %}
{% if o.web_enable_admin_api is defined and o.web_enable_admin_api == 'true' %}
{{ ' \\' }}
{{ '--web.enable-admin-api' -}}
{% endif %}
{% if o.web_console_templates is defined and o.web_console_templates != '' %}
{{ ' \\' }}
{{ '--web.console.templates=' + o.web_console_templates -}}
{% endif %}
{% if o.web_console_libraries is defined and o.web_console_libraries != '' %}
{{ ' \\' }}
{{ '--web.console.libraries=' + o.web_console_libraries -}}
{% endif %}
{% if o.web_page_title is defined and o.web_page_title != '' %}
{{ ' \\' }}
{{ '--web.page-title="' ~ o.web_page_title ~ '\"' -}}
{% endif %}
{% if o.web_cors_origin is defined and o.web_cors_origin != '' %}
{{ ' \\' }}
{{ '--web.cors.origin=' ~ o.web_cors_origin -}}
{% endif %}
{% if o.storage_tsdb_path is defined and o.storage_tsdb_path != '' %}
{{ ' \\' }}
{{ '--storage.tsdb.path=' + o.storage_tsdb_path -}}
{% endif %}
{% if o.storage_tsdb_retention_time is defined and
      o.storage_tsdb_retention_time != '' %}
{{ ' \\' }}
{{ '--storage.tsdb.retention.time=' ~ o.storage_tsdb_retention_time -}}
{% endif %}
{% if o.storage_tsdb_retention_size is defined and
      o.storage_tsdb_retention_size != '' %}
{{ ' \\' }}
{{ '--storage.tsdb.retention.size=' ~ o.storage_tsdb_retention_size -}}
{% endif %}
{% if o.storage_tsdb_no_lockfile is defined and
      o.storage_tsdb_no_lockfile == 'true' %}
{{ ' \\' }}
{{ '--storage.tsdb.no-lockfile' -}}
{% endif %}
{% if o.storage_tsdb_allow_overlapping_blocks is defined and
      o.storage_tsdb_allow_overlapping_blocks == 'true' %}
{{ ' \\' }}
{{ '--storage.tsdb.allow-overlapping-blocks' -}}
{% endif %}
{% if o.storage_tsdb_wal_compression is defined and
      o.storage_tsdb_wal_compression == 'true' %}
{{ ' \\' }}
{{ '--storage.tsdb.wal-compression' -}}
{% endif %}
{% if o.storage_remote_flush_deadline is defined and
      o.storage_remote_flush_deadline != '' %}
{{ ' \\' }}
{{ '--storage.remote.flush-deadline=' ~ o.storage_remote_flush_deadline -}}
{% endif %}
{% if o.storage_remote_read_sample_limit is defined and
      o.storage_remote_read_sample_limit != '' %}
{{ ' \\' }}
{{ '--storage.remote.read-sample-limit=' ~
  o.storage_remote_read_sample_limit -}}
{% endif %}
{% if o.storage_remote_read_concurrent_limit is defined and
      o.storage_remote_read_concurrent_limit != '' %}
{{ ' \\' }}
{{ '--storage.remote.read-concurrent-limit=' ~
  o.storage_remote_read_concurrent_limit -}}
{% endif %}
{% if o.storage_remote_read_max_bytes_in_frame is defined and
      o.storage_remote_read_max_bytes_in_frame != '' %}
{{ ' \\' }}
{{ '--storage.remote.read-max-bytes-in-frame=' ~
  o.storage_remote_read_max_bytes_in_frame -}}
{% endif %}
{% if o.rules_alert_for_outage_tolerance is defined and
      o.rules_alert_for_outage_tolerance != '' %}
{{ ' \\' }}
{{ '--rules.alert.for-outage-tolerance=' ~
  o.rules_alert_for_outage_tolerance -}}
{% endif %}
{% if o.rules_alert_for_grace_period is defined and
      o.rules_alert_for_grace_period != '' %}
{{ ' \\' }}
{{ '--rules.alert.for-grace-period=' ~ o.rules_alert_for_grace_period -}}
{% endif %}
{% if o.rules_alert_resend_delay is defined and
      o.rules_alert_resend_delay != '' %}
{{ ' \\' }}
{{ '--rules.alert.resend-delay=' ~ o.rules_alert_resend_delay -}}
{% endif %}
{% if o.alertmanager_notification_queue_capacity is defined and
      o.alertmanager_notification_queue_capacity != '' %}
{{ ' \\' }}
{{ '--alertmanager.notification-queue-capacity=' ~
   o.alertmanager_notification_queue_capacity -}}
{% endif %}
{% if o.alertmanager_timeout is defined and o.alertmanager_timeout != '' %}
{{ ' \\' }}
{{ '--alertmanager.timeout=' ~ o.alertmanager_timeout -}}
{% endif %}
{% if o.query_lookback_delta is defined and o.query_lookback_delta != '' %}
{{ ' \\' }}
{{ '--query.lookback-delta=' ~ o.query_lookback_delta -}}
{% endif %}
{% if o.query_timeout is defined and o.query_timeout != '' %}
{{ ' \\' }}
{{ '--query.timeout=' ~ o.query_timeout -}}
{% endif %}
{% if o.query_max_concurrency is defined and o.query_max_concurrency != '' %}
{{ ' \\' }}
{{ '--query.max-concurrency=' ~ o.query_max_concurrency -}}
{% endif %}
{% if o.query_max_samples is defined and o.query_max_samples != '' %}
{{ ' \\' }}
{{ '--query.max-samples=' ~ o.query_max_samples -}}
{% endif %}
{% if o.log_level is defined and
  o.log_level in ['debug', 'info', 'warn', 'error'] %}
{{ ' \\' }}
{{ '--log.level=' + o.log_level -}}
{% endif %}
{% if o.log_format is defined and o.log_format in ['logfmt', 'json'] %}
{{ ' \\' }}
{{ '--log.format=' + o.log_format -}}
{% endif %}
{{ '' }}
{% endfor %}
