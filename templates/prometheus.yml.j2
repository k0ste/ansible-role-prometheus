{{ '## prometheus.yml' }}
{{ '# ' + ansible_managed }}
{{ '# Do not edit manually' }}

{{ lookup('ansible.builtin.vars', 'prometheus_instance_settings') |
  ansible.builtin.to_nice_yaml() }}
{% if lookup('ansible.builtin.vars', 'prometheus_rules_settings',
  default='') not in ['', [], '[]', None] %}
{{ 'rule_files:\n  - ' + hostvars[inventory_hostname]['prometheus_conf_dest'] +
  '/prometheus_rules.yml' }}
{% endif %}
